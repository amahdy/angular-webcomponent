
<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/iron-a11y-keys/iron-a11y-keys.html">

<link rel="import" href="../../bower_components/vaadin-valo-theme/vaadin-button.html">
<link rel="import" href="../../bower_components/vaadin-valo-theme/vaadin-text-field.html">
<link rel="import" href="../../bower_components/vaadin-valo-theme/vaadin-form-layout.html">
<link rel="import" href="../../bower_components/vaadin-icons/vaadin-icons.html">
<link rel="import" href="../../bower_components/vaadin-form-layout/vaadin-form-layout.html">

<link rel="import" href="../../bower_components/vaadin-button/vaadin-button.html">
<link rel="import" href="../../bower_components/vaadin-text-field/vaadin-text-field.html">

<dom-module id="person-editor">
  <template>
    <style>
      :host {
        display: block;
      }

      .update-button {
        font-size: 12px;
        width: 100%;
      }

      .delete-button {
        font-size: 12px;
        width: 100%;
      }
    </style>

    <vaadin-form-layout class="with-text-fields">
      <vaadin-text-field placeholder="First Name" id="firstName"></vaadin-text-field>
      <vaadin-text-field placeholder="Last Name" id="lastName"></vaadin-text-field>
      <vaadin-text-field placeholder="E-Mail" id="email"></vaadin-text-field>
      <vaadin-button class="update-button" theme="success" on-tap="update">
        <template is="dom-if" if="[[isUpdate]]">
          <iron-icon icon="vaadin:check-square-o"></iron-icon>
        </template>
        <template is="dom-if" if="[[!isUpdate]]">
          <iron-icon icon="vaadin:user-check"></iron-icon>
        </template>
      </vaadin-button>
      <template is="dom-if" if="[[isUpdate]]">
        <vaadin-button class="delete-button" theme="danger" on-tap="delete">
          <iron-icon icon="vaadin:close"></iron-icon>
        </vaadin-button>
      </template>
    </vaadin-form-layout>
  </template>

  <script>
    Polymer({

      is: 'person-editor',

      properties: {
        person: {
          type: Object,
          value: {},
          observer: '_personChanged'
        },

        isUpdate: {
          type: Boolean,
          value: false
        },
      },

      _personChanged: function() {
        if(this.person && Object.keys(this.person).length) {
          this.$.firstName.value = this.person.firstName;
          this.$.lastName.value = this.person.lastName;
          this.$.email.value = this.person.email;
          this.isUpdate = true;
        }else {
          this.$.firstName.value = '';
          this.$.lastName.value = '';
          this.$.email.value = '';
          this.isUpdate = false;
        }
      },

      update: function() {
        this.person.firstName = this.$.firstName.value;
        this.person.lastName = this.$.lastName.value;
        this.person.email = this.$.email.value;

        if(!this.isUpdate) { /* For create case*/
          this.fire('on-create', {newPerson: this.person});
        }else {
          this.fire('on-update', {newPerson: this.person});
        }
      },

    });
  </script>
</dom-module>
