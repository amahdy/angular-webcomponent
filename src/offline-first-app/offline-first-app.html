
<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/vaadin-valo-theme/vaadin-split-layout.html">

<link rel="import" href="../../bower_components/vaadin-split-layout/vaadin-split-layout.html">

<link rel="import" href="./offline-grid.html">
<link rel="import" href="./person-editor.html">
<link rel="import" href="./person-search.html">

<dom-module id="offline-first-app">
  <template>
    <style>
      :host {
        display: block;
        background-color: var(--valo-contrast-5pct);
      }

      #topLayout {
        height: 100%;
      }

      /* https://github.com/vaadin/vaadin-valo-theme/issues/43 */
      #topLayout > * {
        --valo-size: var(--valo-size-m);
      }

      #offlineGrid {
        display: flex;
        flex: 2;
      }

      #gridArea {
        width: 75%;
        height: 100%;
        display: flex;
        flex-direction: column;
        flex: 10000;
      }

      #editor {
        width: 25%;
        height: 100%;
        padding: 8px;
      }

      #search {
        padding: 8px;
      }
    </style>

    <vaadin-split-layout id="topLayout" theme="subtle">
      <div id="gridArea">
        <person-search id="search"></person-search>
        <offline-grid id="offlineGrid"></offline-grid>
      </div>

      <person-editor id="editor"></person-editor>

    </vaadin-split-layout>
  </template>

  <script>
    Polymer({

      is: 'offline-first-app',

      ready: function() {
        this.$.offlineGrid.addEventListener('on-select', evt => {
          this.$.editor.person = evt.detail.selected;
        });

        this.$.offlineGrid.addEventListener('on-add', evt => {
          this.$.editor.person = {};
        });

        this.$.editor.addEventListener('on-update', evt => {
          this.$.offlineGrid.update(evt.detail.newPerson);
        });

        this.$.editor.addEventListener('on-create', evt => {
          this.$.offlineGrid.create(evt.detail.newPerson);
        });

        this.$.search.addEventListener('on-find', evt => {
          this.$.offlineGrid.search(evt.detail.value);
        });
      },

    });
  </script>
</dom-module>
